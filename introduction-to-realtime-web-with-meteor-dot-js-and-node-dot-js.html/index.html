<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Introduction to Realtime Web with Meteor and Node.js - XguoX - å†™ç‚¹ Ruby ç³Šå£é¥­åƒ</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="XguoX" /><meta name="description" content="æœ€è¿‘,æœ‰è®¸å¤šå…³äº Derby.jsçš„æ¿€åŠ¨äººå¿ƒçš„è®¨è®ºæ¶Œç°åœ¨äº†æˆ‘çš„Twitter Timeline. æˆ‘ä»æœªä½¿ç”¨è¿‡èƒ½å¤Ÿå¸®ä½ åšè¿™ä¹ˆå¤š&amp;ndash;å®æ—¶åŒæ­¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯" /><meta name="keywords" content="Ruby, Golang, Erlang, å‰ç«¯, åç«¯, Android, Elasticsearch, Programmer, Photo, Lens, Camera, Sony, A7r, Fujifilm, Lego" />






<meta name="generator" content="Hugo 0.72.0 with even 4.0.0" />


<link rel="canonical" href="https://xguox.com/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js.html/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.3eafe5cf.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Introduction to Realtime Web with Meteor and Node.js" />
<meta property="og:description" content="æœ€è¿‘,æœ‰è®¸å¤šå…³äº Derby.jsçš„æ¿€åŠ¨äººå¿ƒçš„è®¨è®ºæ¶Œç°åœ¨äº†æˆ‘çš„Twitter Timeline. æˆ‘ä»æœªä½¿ç”¨è¿‡èƒ½å¤Ÿå¸®ä½ åšè¿™ä¹ˆå¤š&ndash;å®æ—¶åŒæ­¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xguox.com/introduction-to-realtime-web-with-meteor-dot-js-and-node-dot-js.html/" />
<meta property="article:published_time" content="2013-03-10T16:01:23+08:00" />
<meta property="article:modified_time" content="2013-03-10T16:01:23+08:00" />
<meta itemprop="name" content="Introduction to Realtime Web with Meteor and Node.js">
<meta itemprop="description" content="æœ€è¿‘,æœ‰è®¸å¤šå…³äº Derby.jsçš„æ¿€åŠ¨äººå¿ƒçš„è®¨è®ºæ¶Œç°åœ¨äº†æˆ‘çš„Twitter Timeline. æˆ‘ä»æœªä½¿ç”¨è¿‡èƒ½å¤Ÿå¸®ä½ åšè¿™ä¹ˆå¤š&ndash;å®æ—¶åŒæ­¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯">
<meta itemprop="datePublished" content="2013-03-10T16:01:23&#43;08:00" />
<meta itemprop="dateModified" content="2013-03-10T16:01:23&#43;08:00" />
<meta itemprop="wordCount" content="4849">



<meta itemprop="keywords" content="Translation,JavaScript," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to Realtime Web with Meteor and Node.js"/>
<meta name="twitter:description" content="æœ€è¿‘,æœ‰è®¸å¤šå…³äº Derby.jsçš„æ¿€åŠ¨äººå¿ƒçš„è®¨è®ºæ¶Œç°åœ¨äº†æˆ‘çš„Twitter Timeline. æˆ‘ä»æœªä½¿ç”¨è¿‡èƒ½å¤Ÿå¸®ä½ åšè¿™ä¹ˆå¤š&ndash;å®æ—¶åŒæ­¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div class="row">
    <div class="col s12 m4">
      <div class="table cover">
        <div class="cover-card table-cell table-middle">

  <img src="/img/logo.jpeg" alt="" class="avatar">

  <a href="https://xguox.com/" class="author_name">XguoX</a>
  <span class="author_job">å†™ç‚¹ Ruby ç³Šå£é¥­åƒ</span>
  <span class="author_bio mbm"> ğŸ¨ é•¿è‰å­¦ç”»ç”» ... </span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="https://xguox.com/">home</a>
        <span>/</span>
      </li>

      <li class="nav-item">
        <a href="https://xguox.com/post/">Archive</a>

          <span>/</span>

      </li>

      <li class="nav-item">
        <a href="https://xguox.com/categories/">Categories</a>
      </li>

    </ul>
  </nav>

  <div class="social-links">
    <ul>
        <li><a href="mailto:xguox@hotmail.com" class="iconfont icon-email" title="email"></a></li>
        <li><a href="https://twitter.com/XguoX_L" class="iconfont icon-twitter" title="twitter"></a></li>
        <li><a href="https://github.com/xguox" class="iconfont icon-github" title="github"></a></li>
    <li>
      <a href="https://xguox.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
    </li>
    </ul>
  </div>

  <section id="js-search" class="p-3 p-lg-5 d-flex flex-column">
    <div class="my-auto" >
      <form action="https://xguox.com/search">
        <input id="search-query" name="s" placeholder="~$ enter to search"/>
      </form>
    </div>
  </section>
</div>
      </div>
    </div>
    <div class="col s12 m8">
      <div class="post-listing">
        
        <div class="container" id="mobile-panel">
          

          <main id="main" class="main">
            <div class="content-wrapper">
              <div id="content" class="content">
                <article class="post inner">
    <a class="home-btn" href= "https://xguox.com/" >
      Home
    </a>
    
    <header class="post-header">
      <h1 class="post-title">Introduction to Realtime Web with Meteor and Node.js</h1>

      <div class="post-meta">
        <span class="post-time"> 10 Mar 2013 </span>
          <span class="more-meta"> 4849 words </span>
          <span class="more-meta"> 10 mins read </span>
        
      </div>
      <div class="post-category">
          <a href="/categories/translation/"> Translation </a>
          <a href="/categories/javascript/"> JavaScript </a>
          </div>
    </header>

    
    <div class="post-content">
      <p>æœ€è¿‘,æœ‰è®¸å¤šå…³äº <a href="http://derbyjs.com/">Derby.js</a>çš„æ¿€åŠ¨äººå¿ƒçš„è®¨è®ºæ¶Œç°åœ¨äº†æˆ‘çš„Twitter Timeline. æˆ‘ä»æœªä½¿ç”¨è¿‡èƒ½å¤Ÿå¸®ä½ åšè¿™ä¹ˆå¤š&ndash;å®æ—¶åŒæ­¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ çš„æ¡†æ¶. ä»æœ¬è´¨ä¸Šè®², è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥è‡ªå·±ç¼–å†™ä¸€ä¸ªä»£ç é‡å¾ˆå°‘çš„åº”ç”¨å¯ä»¥è®©ä¸¤ä¸ªäººç¼–å†™åŒä¸€ä¸ª text fieldâ€“live. è€Œ Derbyå¸®ä½ å¤„ç†äº†åœ¨ models å’Œ views ä¹‹é—´æ‰€æœ‰çš„åŒæ­¥. å°±å¦‚ Google Docs çš„åä½œç¼–è¾‘é‚£æ ·.</p>
<p>è¿™éå¸¸çš„ä¼Ÿå¤§, ä½†ç»è¿‡æ·±å…¥çš„ç ”ç©¶, å‘ç° Derby.js å¹¶æ²¡æœ‰æˆ‘æƒ³è±¡ä¸­çš„é‚£ä¹ˆæˆç†Ÿ&ndash;ç›®å‰è¿˜æ²¡æœ‰åˆ°1.0ç‰ˆæœ¬. å½“ç„¶, Node.js å’Œ Meteor ä¹ŸåŒæ ·æ²¡æœ‰. ä½†ç›¸æ¯”èµ·æ¥, ä¼¼ä¹Derbyç¼ºå°‘çš„æ›´å¤šä¸€äº›. æ¯”å¦‚, æ®æˆ‘ç›®å‰çŸ¥é“çš„, è¿˜æ²¡æœ‰ä¸€ä¸ªå¥½ä½¿çš„æ–¹æ³•æ¥å¤„ç†sessions. æˆ–è®¸æ˜¯å› ä¸ºç¼ºä¹æ–‡æ¡£çš„åŸå› å§, ä½†æ˜¯, æ®è¯´Derbyçš„å›¢é˜Ÿç›®å‰æ­£åœ¨å¼€å‘authentication. å¦‚æœæœ‰è°æœ‰ä¸€äº›å…³äºDerby.js å¤„ç†sessionsçš„æ–°æ‰‹æŒ‡å¼•, æˆ‘ä¼šå¾ˆä¹æ„å»ç ”ç©¶çš„.</p>
<p>å¦å¤–ä¸€ä¸ªæˆ‘ç»å¸¸è§åˆ°è¢«æ‹¿æ¥ä¸Derby.jsåšæ¯”è¾ƒçš„æ¡†æ¶æ˜¯<a href="http://Meteor.com/">Meteor</a>. ä¸Derbyç›¸ä¼¼çš„æ˜¯,å®ƒä¹Ÿèƒ½åœ¨å¤šä¸ªå®¢æˆ·ç«¯ä¸‹å®æ—¶æ›´æ–°views, å°½ç®¡åšæ³•ä¸Šå¯èƒ½è·ŸDerbyæœ‰ç‚¹ä¸åŒ. Derbyå¯ä»¥è¾ƒå®¹æ˜“çš„ä½¿ç”¨å¤šç§æ•°æ®åº“, è€ŒMeteoråˆ™åªäº²è¿‘äº<a href="http://mongodb.org/">MongoDB</a>. äº‹å®ä¸Š, é€šè¿‡å¦‚<a href="http://mongoosejs.com/">Mongoose</a>å®¢æˆ·ç«¯æ¥å…¥æ•°æ®åº“çš„APIä¸ä½ åœ¨æœåŠ¡ç«¯æ‰€æœŸæœ›çš„å·²ç»éå¸¸æ¥è¿‘äº†.</p>
<p>æ¯”èµ·ç°åœ¨nodeçš„ä¸€äº›ç¼ºç‚¹å’Œ<a href="http://bjouhier.wordpress.com/2012/03/11/fibers-and-threads-in-node-js-what-for/">äº‰è®®</a>, Meteorçœ‹èµ·æ¥æ˜¯éå¸¸æœ‰è¶£çš„é€‰æ‹©ç”¨æ¥å»ºç«‹æœ‰å®æ—¶éœ€æ±‚çš„åº”ç”¨. ä¸ªäººè§‰å¾—è¿˜æ˜¯DerbyåŸºäºä¼ ç»Ÿå›è°ƒçš„ç¼–ç¨‹å½¢å¼æ›´å¸å¼•æˆ‘, ä½†åœ¨Derbyçš„å¼ºå¤§èƒŒå,å´ç¼ºä¹å¥å£®çš„æ–‡æ¡£å’Œä¸€ä¸ªå¤§çš„å¼€å‘è€…ç¤¾åŒº, è¿™æ— ç–‘æ˜¯ä¸ªå¾ˆå¤§çš„æ‰“å‡». æˆ–è®¸è¿™ä¼šéšç€æ—¶é—´æ¨ç§»è€Œæœ‰æ‰€æ”¹å˜å§, ä½†æ¯”èµ·Meteoræ¥è¯´è¿˜æ˜¯ä¼šæ…¢å¾ˆå¤š, å› ä¸ºåè€…æœ€è¿‘è·å¾—äº†1100ä¸‡ç¾å…ƒçš„èµ„é‡‘. è¿™ç¬”è´¢æ”¿èµ„é‡‘ç¡®ä¿äº†Meteorçš„å­˜åœ¨ä»¥åŠå¾—åˆ°æŒç»­çš„æ”¯æŒ. å¯¹äºé‚£äº›éœ€è¦è´¢æ”¿ä¸å‘å±•ç¨³å®šçš„æ¡†æ¶çš„å¼€å‘è€…è€Œè¨€, è¿™ç¬”èµ„é‡‘åªä¼šè®©Meteoræ›´åŠ ä¼˜èƒœ.</p>
<p>ä»Šå¤©,è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•æ–°å»ºä¸€ä¸ªçœŸå®çš„ä½†åˆç®€å•çš„Meteoråº”ç”¨. æœ¬è´¨ä¸Šè¯´, è¿™æ˜¯åŸºäº<a href="http://vimeo.com/40300075">Tomçš„ Vimeo screencast</a>çš„ä¸€ä¸ªæ–°æ‰‹æŒ‡å¼•. ä¸Tomçš„ Vimeo screencastæœ€å¤§çš„ä¸åŒæ˜¯å¤„ç†äº‹ä»¶çš„æ–¹å¼. æ¯”èµ·å¤åˆ¶ç²˜è´´ä¸€ä¸ªMeteorç¤ºä¾‹çš„ä»£ç , æˆ‘ä¼šä¸€æ­¥ä¸€æ­¥çš„é€šè¿‡è‡ªå·±çš„æ–¹å¼æ¥å¤„ç†ä½¿ç”¨Enteré”®æ¥æäº¤ä¸€åˆ™è®¯æ¯. è®©æˆ‘ä»¬å¼€å§‹å§.</p>
<h5 id="creating-a-meteor-app">Creating a Meteor App</h5>
<p>Derbyå’ŒMeteor ä»–ä»¬å…±æœ‰çš„ä¸€ä¸ªå¤§åŠ åˆ†æ˜¯ä»–ä»¬å„è‡ªçš„å‘½ä»¤è¡Œå·¥å…·. ä¸Derbyä½¿ç”¨Nodeçš„å†…ç½®çš„ npm å·¥å…·æ‰€ä¸åŒçš„æ˜¯, Meteorä½¿ç”¨çš„æ˜¯å®ƒè‡ªå·±çš„.</p>
<p>åœ¨ç»ˆç«¯(Mac OS X å’Œ Linux),æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤. (åœ¨è¿™ä¹‹å‰è¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº†Node)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">curl</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//ins</span><span class="n">tall</span><span class="o">.</span><span class="n">Meteor</span><span class="o">.</span><span class="n">com</span> <span class="o">|</span> <span class="sr">/bin/s</span><span class="n">h</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥çš„äº‹Meteorä¼šè‡ªå·±æå®šäº†.</p>
<p>è¦æ–°å»ºä¸€ä¸ªé¡¹ç›®, å…ˆè½¬åˆ°ä½ çš„å·¥ä½œç›®å½•ç„¶åè¿è¡Œä¸‹è¾¹çš„ä»£ç . è¿™ä¼šåˆ›å»ºä¸€ä¸ªç›®å½•, é‡Œè¾¹åŒ…æ‹¬æœ‰Meteorå’Œä¸€ä¸ªæœ€åŸºæœ¬æ¨¡æ¿ç¨‹åº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="no">Meteor</span> <span class="n">create</span> <span class="n">chat</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨, ä½ å¯ä»¥è½¬åˆ°è¯¥ç›®å½•å¹¶è¿è¡Œä¸‹é¢çš„ä»£ç è®©å®ƒè·‘èµ·æ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">cd</span> <span class="n">chat</span>
<span class="err">$</span> <span class="no">Meteor</span>
<span class="no">Running</span> <span class="ss">on</span><span class="p">:</span> <span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="ss">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span>
</code></pre></td></tr></table>
</div>
</div><p>æƒ³è¦çœ‹åˆ°è¿™ä¸ªæœ€åŸºç¡€çš„åº”ç”¨ç¨‹åº, ä½ åªéœ€è¦åœ¨ä»»æ„ä¸€æ¬¾ä¸è¿‡æ—¶çš„æµè§ˆå™¨ä¸‹æ‰“å¼€<code>http://localhost:3000/</code></p>
<p>åªè¦ä½ æƒ³, ä½ å¯ä»¥ä½¿ç”¨Meteorå†…ç½®çš„<code>Meteor deploy</code>å‘½ä»¤æ¥éƒ¨ç½²ä½ çš„åº”ç”¨åˆ°Meteorè‡ªå·±çš„æœåŠ¡å™¨ä¸Š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="no">Meteor</span> <span class="n">deploy</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="nb">name</span><span class="o">.</span><span class="n">Meteor</span><span class="o">.</span><span class="n">com</span>
</code></pre></td></tr></table>
</div>
</div><p>åªè¦ä½ æ›´æ–°ä¿å­˜äº†ä½ çš„ä»£ç , æ‰€æœ‰è¿æ¥ä¸Šçš„æµè§ˆå™¨éƒ½ä¼šå®æ—¶æ›´æ–°å…¶é¡µé¢.</p>
<h5 id="developing-the-chat-app">Developing the Chat App</h5>
<p>é€šè¿‡<code>Meteor create</code>å‘½ä»¤ç”Ÿæˆçš„æ–‡ä»¶å¤¹é‡Œ, ä½ å¯ä»¥çœ‹åˆ°å‡ ä¸ªä¸åŒçš„æ–‡ä»¶. å¦‚æœä½ çš„ç³»ç»Ÿè®¾ç½®äº†æ˜¾ç¤ºéšè—æ–‡ä»¶, é‚£è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>.Meteor</code>æ–‡ä»¶å¤¹. è¿™ä¸ªæ–‡ä»¶å¤¹åŒ…æ‹¬çš„Meteoræœ¬èº«, ä»¥åŠMongoDBæ•°æ®åº“çš„æ–‡ä»¶.</p>
<p>åœ¨ä½ çš„é¡¹ç›®çš„æ ¹ç›®å½•, ä½ å¯ä»¥çœ‹åˆ°çš„è¿˜æœ‰<code>chat.html</code> <code>chat.js</code> <code>chat.css</code>. è¿™ä¸‰ä¸ªæ–‡ä»¶è‡ªè§£é‡Š?çš„. HTMLåŒ…å«äº†è¿™ä¸ªåº”ç”¨çš„æ¨¡æ¿å’Œè§†å›¾, å¹¶éƒ½é€šè¿‡<code>chat.css</code>æ¥æ·»åŠ æ ·å¼. è€Œè¿™ä¸ªJavaScriptæ–‡ä»¶åˆ™åŒ…å«äº†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ‰§è¡Œçš„ä»£ç . è¿™éå¸¸çš„é‡è¦&ndash;è¯·ä¸è¦æŠŠä»»ä½•ä¸œè¥¿æ¯”å¦‚é…ç½®æ•°æ®å’Œå¯†ç éƒ½æ”¾åœ¨è¿™é‡Œ, å› ä¸ºä»»ä½•äººéƒ½èƒ½é€šè¿‡æŸ¥çœ‹ä½ çš„åº”ç”¨ç¨‹åºçš„æºæ–‡ä»¶çœ‹åˆ°.</p>
<p>ç”¨ä½ æœ€å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€<code>chat.js</code>. æˆ‘ä¸ªäººä½¿ç”¨çš„æ˜¯<a href="http://sublimetext.com/">Sublime Text 2</a>, å› ä¸ºå®ƒå¾ˆç®€æ´å¹¶ä¸”æœ‰å¤šå…‰æ ‡åŠŸèƒ½.
ä½ å¯ä»¥åœ¨<code>chat.js</code>çœ‹åˆ°ä¸‹é¢è¿™äº›ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">greeting</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&#34;Welcome to chat.&#34;</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;click input&#39;</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="c1">// template data, if any, is available in &#39;this&#39;
</span><span class="c1"></span>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">console</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;You pressed the button&#34;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_server</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// code to run on server at startup
</span><span class="c1"></span>  <span class="p">});</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åˆ†åˆ«æ³¨æ„åˆ°<code>if</code>è¯­å¥é‡Œçš„<code>Meteor.is_client</code>å’Œ<code>Meteor.is_server</code>éƒ¨åˆ†. åœ¨è¿™é‡Œè¾¹çš„ä»£ç åˆ†åˆ«åªåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸‹æ‰§è¡Œ. è¿™å°±æ˜¯Meteorå…±ç”¨ä»£ç çš„èƒ½åŠ›äº†.</p>
<p>åˆ é™¤æ‰<code>Meteor.is_server</code>è¿™æ®µä»£ç å¹¶æŠŠ<code>if (Meteor.is_client)</code>é‡Œè¾¹çš„ä»£ç åˆ é™¤äº†,åªç•™å¦‚ä¸‹éƒ¨åˆ†:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„åˆ°, å½“ä½ ä¿å­˜äº†ä½ çš„è„šæœ¬ä¹‹å, æµè§ˆå™¨ä¼šé©¬ä¸Šé‡æ–°åŠ è½½è¿™ä¸ªæ–°è„šæœ¬.</p>
<h5 id="creating-the-view">Creating the View</h5>
<p>åœ¨æˆ‘ä»¬æ­£å¼å¯¹è¿™ä¸ªè„šæœ¬æ–‡ä»¶åŠ¨å·¥ä¹‹å‰, æˆ‘ä»¬éœ€è¦å…ˆæ–°å»ºä¸€ä¸ªè§†å›¾ç”¨æ¥å±•ç¤ºèŠå¤©è®°å½•.
åœ¨ç¼–è¾‘å™¨é‡Œæ‰“å¼€<code>chat.html</code>å¹¶åˆ é™¤<code>body</code>æ ‡ç­¾é‡Œè¾¹çš„ä»£ç . åŒ…æ‹¬åä¸ºhelloçš„<code>template</code>æ ‡ç­¾.åªç•™å¦‚ä¸‹éƒ¨åˆ†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>chat<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ç€åœ¨<code>body</code>æ ‡ç­¾é‡Œæ·»åŠ ä¸‹é¢è¿™å¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">\{\{ &gt; entryfield}}
</code></pre></td></tr></table>
</div>
</div><p>Meteorä½¿ç”¨çš„æ¨¡æ¿ç³»ç»Ÿä¸<a href="http://mustache.github.com/">Mustache</a>å¾ˆç›¸ä¼¼.å¤§æ‹¬å·{{}}<code>è¡¨ç¤ºè¦å‘ˆç°çš„å†…å®¹. é€šè¿‡ç®€å•åœ°åœ¨ä¸¤å¯¹å¤§æ‹¬å·é‡Œæ·»åŠ å†…å®¹å¦‚{{hello}}</code>, æ¨¡æ¿ç³»ç»Ÿä¼šç”¨<code>hello</code>è¿™ä¸ªå˜é‡çš„å€¼æ¥æ›¿æ¢å®ƒ. åé¢ä¼šæ›´è¯¦ç»†çš„ä»‹ç».</p>
<p>æ³¨æ„åˆ°äº†åœ¨<code>entryfield</code>è¿™ä¸ªè¯å‰é¢æœ‰ä¸ªå¤§äºå·<code>&gt;</code>äº†å—? ä½¿ç”¨è¯¥ç¬¦å·æ¥æŒ‡å®šæ¸²æŸ“å“ªä¸€ä¸ªæ¨¡æ¿.</p>
<p>æ¥ä¸‹æ¥ä½¿ç”¨ä¸‹é¢è¿™æ®µä»£ç æ¥æ–°å»ºä¸€ä¸ªåå«<code>entryfield</code>çš„æ¨¡æ¿</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">template</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;entryfield&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;name&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Name&#34;</span> <span class="p">/&gt;</span> <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;message&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Your Message&#34;</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­,<code>template</code>æ ‡ç­¾åªæœ‰ä¸€ä¸ªå±æ€§&ndash;ç”¨æ¥è¡¨ç¤ºè¿™ä¸ªtemplateçš„åå­—. ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬æ¸²æŸ“çš„æ—¶å€™éœ€è¦ç”¨æ¥æŒ‡å®šçš„åå­—.</p>
<p>æŸ¥çœ‹æµè§ˆå™¨, ä½ ä¼šå‘ç°é¡µé¢å·²ç»åˆ·æ–°äº†, è¾“å…¥æ¡†å·²ç»å‘ˆç°å‡ºæ¥äº†.</p>
<p>æ¥ä¸‹æ¥, åœ¨bodyé‡Œè¾¹æ·»åŠ å¦å¤–çš„ä¸€ä¸ªmutacheæ ‡ç­¾ç”¨ä»¥æ¸²æŸ“è®¯æ¯åˆ—è¡¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">\{\{&gt; message}}
</code></pre></td></tr></table>
</div>
</div><p>æœ€å, æˆ‘ä»¬è¿˜éœ€è¦æ–°å»ºä¸€ä¸ªåå«<code>messages</code>çš„æ¨¡æ¿. åœ¨<code>entryfield</code>æ¨¡æ¿ä¸‹é¢æ·»åŠ ä¸‹é¢è¿™æ®µä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">template</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;messages&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
       \{\{#each messages}}
            <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>{{name}}<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>- {{message}}
       \{\{/each}}
	<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„åˆ°<code>each</code>å­å¥. åœ¨Meteorä¸­ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„è¯­æ³•æ¥éå†ä¸€ä¸ªæ•°ç»„æ¨¡æ¿</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">\{\{#each [name of array]}}
\{\{/each}}
</code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨eachå¾ªç¯æ—¶,ä¸Šä¸‹æ–‡ä¼šæœ‰æ‰€æ”¹å˜. å½“å¼•ç”¨å˜é‡çš„æ—¶å€™, å®é™…ä¸Šä½ å¼•ç”¨çš„æ˜¯æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å€¼.
ä¾‹å¦‚,åœ¨æˆ‘ä»¬çš„chatåº”ç”¨ä¸­, æˆ‘ä»¬éå†äº†æ•°ç»„æ¨¡æ¿&quot;messages&quot;é‡Œè¾¹çš„æ¯ä¸ªå…ƒç´ , è¯¥æ•°ç»„å¯ä»¥åƒä¸‹é¢è¿™æ ·,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&#34;name&#34;</span><span class="o">:</span> <span class="s2">&#34;Andrew&#34;</span><span class="p">,</span>
        <span class="s2">&#34;message&#34;</span><span class="o">:</span> <span class="s2">&#34;Hello world!&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&#34;name&#34;</span><span class="o">:</span> <span class="s2">&#34;Bob&#34;</span><span class="p">,</span>
        <span class="s2">&#34;message&#34;</span><span class="o">:</span> <span class="s2">&#34;Hey, Andrew!&#34;</span>
    <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶å, åœ¨eachå¾ªç¯ä¸­, ä½ å¯ä»¥çœ‹åˆ°{{message}}<code> {{name}}</code>, è¿™ä¼šå¼•ç”¨ æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å€¼æ¥æ›¿ä»£(Andrew å’Œ Bob æ›¿æ¢ name, ä»¥åŠå„è‡ªçš„é—®å€™ä¿¡æ¯.)</p>
<p>å½“è¿”å›åˆ°ä½ çš„æµè§ˆå™¨, ä½ è¿˜çœ‹ä¸åˆ°ä»»ä½•çš„æ”¹å˜. å› ä¸ºè®¯æ¯æ•°ç»„è¿˜æ²¡è¢«ä¼ é€åˆ°æ¨¡æ¿, æ‰€ä»¥Meteoréå†ä¸åˆ°ä»»ä½•ä¸œè¥¿æ¥å‘ˆç°.</p>
<p>ä½ çš„<code>chat.html</code>æœ€ååº”è¯¥æ˜¯è¿™æ ·çš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>chat<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  \{\{&gt; entryfield}}
  \{\{&gt; messages}}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">template</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;entryfield&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;name&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Name&#34;</span> <span class="p">/&gt;</span> <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;message&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Your Message&#34;</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">template</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;messages&#34;</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
		\{\{#each messages}}
            <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>{{name}}<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>- {{message}}<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>
        \{\{/each}}
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="the-javascript">The Javascript</h5>
<p>ä»ç°åœ¨å¼€å§‹, æˆ‘ä»¬å¤„ç†çš„å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯å®¢æˆ·ç«¯ä»£ç , æ‰€ä»¥, é™¤éç‰¹åˆ«è¯´æ˜, ä»¥ä¸‹çš„ä»£ç éƒ½æ˜¯åœ¨<code>if (Meteor.is_client)</code>ä»£ç å—ä¸­.</p>
<p>åœ¨æˆ‘ä»¬ç¼–å†™å±•ç¤ºè®¯æ¯çš„ä»£ç ä¹‹å‰,è®©æˆ‘ä»¬å…ˆæ–°å»ºä¸€ä¸ª<code>Collection</code>. ä»æœ¬è´¨ä¸Šè®², è¿™æ˜¯ä¸€ç»„Models. æ¢å¥è¯è¯´, åœ¨è¿™ä¸ªchatåº”ç”¨çš„ç¯å¢ƒä¸‹, Messages collectionä¿å­˜ç€æ•´ä¸ªèŠå¤©è®°å½•, è€Œæ¯æ¡è®¯æ¯è®°å½•æ˜¯ä¸€ä¸ªModel.</p>
<p>åœ¨ifè¯­å¥å‰, æ·»åŠ å¦‚ä¸‹ä»£ç æ¥åˆå§‹åŒ–Collection:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªCollectionå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¢«åˆ›å»º, æ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒå†™åœ¨äº†å®¢æˆ·ç«¯ä»£ç å—ä¹‹å¤–.</p>
<p>ç”±äºMeteorä¸ºæˆ‘ä»¬åšäº†å¤§éƒ¨åˆ†çš„å·¥ä½œ, è¦å±•ç¤ºèŠå¤©è®°å½•æ˜¯éå¸¸å®¹æ˜“çš„. åªéœ€è¦æŠŠä¸‹é¢çš„ä»£ç æ·»åŠ è¿›ifè¯­å¥é‡Œè¾¹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è®©æˆ‘ä»¬æ‹†å¼€æ¥åˆ†æè¿™æ®µä»£ç :</p>
<p><strong>Template</strong>.messages.messages = function(){ â€¦ }</p>
<p>ç¬¬ä¸€éƒ¨åˆ†<code>Template</code>è¡¨ç¤ºæˆ‘ä»¬æ­£åœ¨ä¿®æ”¹ä¸€ä¸ªæ¨¡æ¿çš„è¡Œä¸º.</p>
<p>Template.<strong>messages</strong>.messages = function(){ â€¦ }</p>
<p>ç¬¬äºŒéƒ¨åˆ†<code>messages</code>æ˜¯æ¨¡æ¿çš„åå­—, è¡¨ç¤ºæ˜¯åœ¨ä¿®æ”¹å“ªä¸€ä¸ªæ¨¡æ¿.</p>
<p>ä¾‹å¦‚,å¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹&quot;entryfield&quot;æ¨¡æ¿åšäº›ä»€ä¹ˆ,   åªéœ€æŠŠä»£ç æ”¹æˆ<code>Template.entryfields.variable = function(){ â€¦ }</code>(åœ¨è¿™é‡Œ, è¯·åˆ«è¿™ä¹ˆåš)</p>
<p>Template.messages.<strong>messages</strong> = function(){ â€¦ }</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†çš„è¿™ä¸ª<code>messages</code>ä»£è¡¨çš„æ˜¯ä¸€ä¸ªè¿™ä¸ªæ¨¡æ¿é‡Œçš„ä¸€ä¸ªå˜é‡. è¿˜è®°å¾—æˆ‘ä»¬çš„eachå¾ªç¯éå†<code>messages</code>å—? è¿™å°±æ˜¯é‚£ä¸ªmesaages.</p>
<p>å½“ä½ æ‰“å¼€æµè§ˆå™¨æ—¶, é¡µé¢è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆæ”¹å˜. è¿™æ˜¯æ„æ–™ä¹‹ä¸­çš„äº‹, å› ä¸ºæˆ‘ä»¬åªæŠ“å–çš„è®¯æ¯, è€Œæ²¡æœ‰å±•ç¤ºå‡ºæ¥.</p>
<p>æ­¤æ—¶,ä½ çš„<code>chat.js</code>åº”è¯¥æ˜¯è¿™æ ·çš„. æ˜¯å¦å¾ˆæƒŠè®¶å°±åªéœ€åœ¨æœåŠ¡å™¨å†™è¿™ä¹ˆäº›ä»£ç æˆ‘ä»¬å°±èƒ½å±•ç¤ºä¸€ä¸ªå®æ—¶çš„èŠå¤©è®°å½•åº”ç”¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Messages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">is_client</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Template</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="nx">Messages</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span> <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">time</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="adding-a-message-through-the-console">Adding a Message through the Console</h5>
<p>è¿™éƒ¨åˆ†çš„å†…å®¹æ˜¯å¯é€‰çš„, å½“ç„¶å®ƒæœ‰åŠ©äºä½ è°ƒè¯•ç¨‹åº. ä½ å¯ä»¥ç›´æ¥è·³è¿‡å¾€ä¸‹å­¦ä¹ å»ºç«‹formæ¥å“åº”key press.</p>
<p>å¦‚æœä½ æƒ³è¦æµ‹è¯•ä½ çš„è®¯æ¯æ˜¾ç¤ºä»£ç , ä½ å¯ä»¥æ‰‹åŠ¨æ’å…¥ä¸€æ¡è®°å½•åˆ°æ•°æ®åº“. æ‰“å¼€ä½ çš„æµè§ˆå™¨æ§åˆ¶å°, å¹¶è¾“å…¥å¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Messages.insert({ name: &#39;Andrew&#39;, message: &#39;Hello world!&#39;, time: 0 })
</code></pre></td></tr></table>
</div>
</div><p>è¿™å°†ä¼šåœ¨æ•°æ®åº“ä¸­æ–°å»ºä¸€æ¡è®°å½•, å¦‚æœæ­£ç¡®çš„æ“ä½œäº†çš„è¯,é‚£æµè§ˆå™¨å°±ä¼šå³åˆ»æ›´æ–°è¿™æ¡è®¯æ¯åœ¨é¡µé¢ä¸Š.</p>
<h5 id="the-message-entry-form">The Message Entry Form</h5>
<p>è¿”å›åˆ°<code>chat.js</code>, æˆ‘ä»¬å³å°†è¦å®Œæˆçš„æ˜¯å…è®¸ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­æäº¤èŠå¤©è®¯æ¯åˆ°æ•°æ®åº“.
åœ¨ifè¯­å¥é‡Œå¤´æœ€ä¸‹é¢æ·»åŠ ä¸‹é¢è¿™æ®µä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Template</span><span class="p">.</span><span class="nx">entryfield</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&#34;keydown #message&#34;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">which</span> <span class="o">==</span> <span class="mi">13</span><span class="p">){</span>
      <span class="c1">// Submit the form
</span><span class="c1"></span>      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">);</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
        <span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
          <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
          <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
          <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
        <span class="p">});</span>

        <span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="nx">message</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç æ¯”è¾ƒå¤š, è®©æˆ‘ä»¬ä¸€æ­¥æ­¥åˆ†æ. ä½ åº”è¯¥è¿˜æœ‰å°è±¡, ç´§è·Ÿ<code>Template</code>ä¹‹åçš„è¯è¡¨ç¤ºæˆ‘ä»¬å³å°†è¦ä¿®æ”¹çš„templateçš„åå­—. è·Ÿå‰é¢ä¿®æ”¹çš„æ¨¡æ¿æ˜¯<code>messages</code>ä¸ä¸€æ ·çš„æ˜¯, è¿™é‡Œæˆ‘ä»¬è¦ä¿®æ”¹çš„æ˜¯<code>entryfield</code>.
templateçš„<code>event</code>å±æ€§ä¼šåŒ…å«æœ‰ä¸€ä¸ªå¯¹è±¡, è¿™ä¸ªå¯¹è±¡çš„keysçš„æ ¼å¼å¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&#34;[eventname] [selector]&#34;
</code></pre></td></tr></table>
</div>
</div><p>æ¯”å¦‚, å¦‚æœæˆ‘ä»¬æƒ³ç»‘å®šäº†ä¸€ä¸ª<code>click</code>äº‹ä»¶ç»™äº†IDä¸º<code>hello</code>çš„æŒ‰é’®. åˆ™éœ€è¦åƒä¸‹é¢è¿™æ ·æ·»åŠ ä¸€ä¸ª<code>events</code>å¯¹è±¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&#34;click #hello&#34;: function(event){ â€¦ }
</code></pre></td></tr></table>
</div>
</div><p>åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­,æˆ‘ä»¬ç»‘å®šäº†ä¸€ä¸ª<code>keydown</code>äº‹ä»¶ç»™äº†IDä¸º<code>message</code>çš„è¾“å…¥æ¡†. è¿™ä¸ªè¾“å…¥æ¡†åœ¨æˆ‘ä»¬ä¸€å¼€å§‹çš„<code>chat.html</code>å·²ç»å»ºå¥½.</p>
<p>åœ¨<code>events</code>å¯¹è±¡é‡Œ, æ¯ä¸€ä¸ªkeyéƒ½æœ‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®ƒçš„å€¼. å½“äº‹ä»¶è¢«è§¦å‘çš„æ—¶å€™, è¿™ä¸ª<code>event</code>å¯¹è±¡ä¼šè¢«ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ ç»™è¿™ä¸ªå‡½æ•°.åœ¨æˆ‘ä»¬çš„chatåº”ç”¨, æ¯ä¸€æ¬¡åœ¨è¾“å…¥æ¡†ä¸­æŒ‰ä¸‹ä¸€ä¸ªæŒ‰é”®(<code>keydown</code>), è¿™ä¸ªå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨.</p>
<p>åœ¨å‡½æ•°é‡Œçš„ä»£ç éå¸¸ç®€å•. é¦–å…ˆ, æˆ‘ä»¬å…ˆè¦æ£€æµ‹æŒ‰ä¸‹çš„æ˜¯å¦&quot;enter&quot;é”®(&ldquo;enter&quot;çš„keycode æ˜¯13). æ¥ç€,é€šè¿‡IDæ¥å¾—åˆ°ä¸¤ä¸ªè¾“å…¥æ¡†ä¸­çš„DOMå…ƒç´ . æœ€å, æˆ‘ä»¬æ£€æŸ¥ç¡®ä¿è¾“å…¥æ¡†ä¸­çš„å€¼ä¸ä¸ºç©º, ç”¨æˆ·ä¸å…è®¸å‘é€ç©ºçš„åå­—å’Œè®¯æ¯.</p>
<p>ä¸‹é¢çš„ä»£ç éœ€è¦æ³¨æ„äº†, å®ƒä¼šè¢«ç›´æ¥æ’å…¥åˆ°æ•°æ®åº“ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Messages</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
  <span class="nx">message</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
  <span class="nx">time</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½ ä¼šå‘ç°,è¿™å…¶å®è·Ÿæˆ‘ä»¬ç›´æ¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¾“å…¥çš„ä»£ç å¾ˆç›¸ä¼¼, åªæ˜¯æˆ‘ä»¬ç”¨DOMå…ƒç´ çš„å€¼æ¥æ›¿æ¢å›ºå®šå€¼. å¦å¤–, æ¬§æ–‡æœ¨è®·æ·»åŠ äº†æ—¶é—´å€¼æ¥ç¡®ä¿æ˜¯æŒ‰ç…§æ—¶é—´æ¥æ’åº.</p>
<p>æœ€å,æˆ‘ä»¬æŠŠä¸¤ä¸ªè¾“å…¥æ¡†è®¾ç½®ä¸ºç©º<code>''</code></p>
<p>ç°åœ¨, ä½ å¯ä»¥æ‰“å¼€æµè§ˆå™¨å°è¯•åœ¨è¾“å…¥æ¡†è¾“å…¥åå­—å’Œè®¯æ¯. æŒ‰ä¸‹&quot;enter&quot;å,è¾“å…¥æ¡†ä¼šè¢«è¢«æ¸…ç©º, è€Œä¸”è¿™åˆ™è®¯æ¯ä¼šç«‹é©¬å‡ºç°åœ¨ä½ çš„è¾“å…¥æ¡†ä¸‹è¾¹. ä½¿ç”¨å¦å¤–ä¸€ä¸ªæµè§ˆå™¨çª—å£æˆ–è€…å…¶ä»–æµè§ˆå™¨æ‰“å¼€åŒæ ·çš„é“¾æ¥(<code>http://127.0.0.1:3000</code>).	å°è¯•è¾“å…¥ä¸€åˆ™æ–°çš„è®¯æ¯, æ­¤æ—¶ä½ å°±ä¼šçœ‹åˆ°Meteorçš„å¼ºå¤§ä¹‹å¤„.æ— é¡»å•ç‹¬å†™ä¸€è¡Œä»£ç æ¥æ›´æ–°è®¯æ¯è®°å½•, å°±å¯ä»¥å®æ—¶åŒæ­¥åœ¨ä¸åŒçš„å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­.</p>
<h5 id="conclusion">Conclusion</h5>
<p>While Meteor is pretty cool to work with and there are some pretty useful applications for it, like Derby.js, it is immature. For examples of this, just browse through the documentation and look for the red quotations. For example, the documentation states the following about MongoDB collections:</p>
<blockquote>
<p>Currently the client is given full write access to the collection. They can execute arbitrary Mongo update commands. Once we build authentication, you will be able to limit the client&rsquo;s direct access to insert, update, and remove. We are also considering validators and other ORM-like functionality.</p>
</blockquote>
<p>å¯¹äºä»»ä½•ä¸€ä¸ªäº§å“è€Œè¨€, ç”¨æˆ·æ‹¥æœ‰æ•°æ®åº“çš„æ‰€æœ‰è¯»å†™æƒé™éƒ½æ˜¯éå¸¸å¤§çš„é—®é¢˜, éå¸¸å±é™©.</p>
<p>åŸæ–‡æ¥è‡ªAndrew Munsell <a href="http://www.andrewmunsell.com/blog/introduction-to-realtime-web-Meteor-and-nodejs/#.UTyJZtHN-tv">Introduction to Realtime Web with Meteor and Node.js</a></p>
<p>å¦é™„ä¸ŠTomçš„ Vimeo screencast(éœ€FanQiang)
<a href="http://av.vimeo.com/31624/419/93304834.mp4?aksessionid=d86b5b612c86d70bd2022ae1050aa1be&amp;token=1362992353_ce10e413b18fa6f2d0e3483ef6b82894">http://av.vimeo.com/31624/419/93304834.mp4?aksessionid=d86b5b612c86d70bd2022ae1050aa1be&amp;token=1362992353_ce10e413b18fa6f2d0e3483ef6b82894</a> 640 320 <a href="http://b.vimeocdn.com/ts/278/431/278431171_960.jpg">http://b.vimeocdn.com/ts/278/431/278431171_960.jpg</a></p>

    </div>

    <footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/translation/">Translation</a>
          <a href="/tags/javascript/">JavaScript</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/5-meteor-misconceptions.html/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">5 Meteor Misconceptions</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/learn-meteor-fundamentals-and-best-practices.html/">
            <span class="next-text nav-default">Meteor åŸºç¡€ä¸æœ€ä½³å®è·µ</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
              </div>
              <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'xguox';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            </div>
          </main>

          <footer id="footer" class="footer">
            <div class="social-links">
      <a href="mailto:xguox@hotmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/XguoX_L" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/xguox" class="iconfont icon-github" title="github"></a>
  <a href="https://xguox.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme -
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy;
    2011 -
    2021
    <span class="heart">
      <i class="iconfont icon-bulb"></i>
    </span>
    <span class="author">XguoX</span>
  </span>
</div>
          </footer>

          <div class="back-to-top" id="back-to-top">
            <i class="iconfont icon-up"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.733a52a9.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-62252083-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
